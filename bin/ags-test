#!/bin/bash
# Agent Sandbox Test (ags-test) - Test script for agent.py

set -e
set -o pipefail

# Get the directory where this script is located
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_DIR="$(dirname "$SCRIPT_DIR")"

# Change to example directory and activate virtual environment
cd "$PROJECT_DIR/example"
source "$PROJECT_DIR/venv/bin/activate"

# Clean up any existing agent resources before running
echo "Cleaning up existing agent resources..."
rm -rf "$PROJECT_DIR/worktrees/agent--"* 2>/dev/null || true

# Set PYTHONPATH and run agent with simple test task
export PYTHONPATH="$PROJECT_DIR:$PYTHONPATH"
exec python -m src.main start "Write a simple hello world Go program."
