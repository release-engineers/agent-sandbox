#!/bin/bash
# Agent Sandbox (ags-server) - Start the FastAPI server

set -e
set -o pipefail

# Get the directory where this script is located
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_DIR="$(dirname "$SCRIPT_DIR")"

# Activate virtual environment
source "$PROJECT_DIR/venv/bin/activate"

# Set PYTHONPATH to include project directory and start the server
export PYTHONPATH="$PROJECT_DIR:$PYTHONPATH"
exec python -c "
import uvicorn
uvicorn.run(
    'src.server:app', 
    host='127.0.0.1', 
    port=8000,
    reload=True,
    log_level='info'
)
"